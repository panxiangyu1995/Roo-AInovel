# 小说框架完善工具测试方案

## 1. 概述

本测试方案旨在验证小说框架完善工具在不同场景下的功能正确性和用户体验。通过模拟用户使用小说框架模式的完整流程，确保工具能够稳定运行并满足用户需求。

## 2. 测试环境

- **操作系统**: Windows 10/11, macOS, Linux
- **VSCode版本**: 最新稳定版
- **扩展依赖**: 确保所有依赖扩展已正确安装
- **模式**: 小说框架模式(planner)

## 3. 测试前准备

1. 确保已切换到小说框架模式(planner)
2. 准备测试用的框架文件（空文件和已有内容的文件）
3. 清理之前的测试状态文件（如有）

## 4. 测试场景

### 4.1 新建框架文件测试

#### 测试步骤

1. **初始化工具**
   ```
   <novel_framework_refine>
   <path>test-framework.md</path>
   </novel_framework_refine>
   ```

2. **输入小说标题**
   - 输入: "龙城秘境"

3. **输入小说概念**
   - 输入: "一个普通大学生意外获得古老传承，能够穿梭于现代都市和远古龙城之间，逐渐揭开两个世界的神秘联系。"

4. **选择要完善的部分**
   - 输入: "1"（选择小说题材）

5. **选择题材类型**
   - 输入: "都市/玄幻"

6. **继续完善或跳转**
   - 输入: "4"（跳转到角色设计部分）

7. **完成角色设计后**
   - 输入: "6"（结束框架完善，切换到写作模式）

#### 预期结果

- 成功创建新的框架文件
- 文件包含基本结构和用户输入的内容
- 小说题材部分包含都市/玄幻相关内容
- 角色设计部分包含基本角色设定
- 工具提示切换到写作模式成功

### 4.2 完善现有框架文件测试

#### 测试前准备

创建一个包含部分内容但缺少某些部分的框架文件，例如：

```markdown
# 星际迷航 - 小说框架设计

## 核心概念

人类在宇宙中探索未知文明，面对各种科技和道德挑战。

## 主要角色

### 舰长
勇敢、果断、富有领导力的星际舰队舰长

### 科学官
理性、冷静、对未知充满好奇的科学官

## 世界观设定

人类已经发展出曲速技术，能够进行星际旅行，并与多个外星文明建立了联系。
```

#### 测试步骤

1. **初始化工具**
   ```
   <novel_framework_refine>
   <path>existing-framework.md</path>
   </novel_framework_refine>
   ```

2. **查看分析结果**
   - 系统应显示缺少的部分

3. **选择添加小说题材**
   - 输入相应选项

4. **选择科幻题材**
   - 完成题材设定

5. **添加故事大纲**
   - 选择添加情节大纲选项
   - 完成大纲设计

6. **检查更新后的文件**
   - 验证新增内容是否正确添加

#### 预期结果

- 工具正确识别现有内容和缺失部分
- 成功添加小说题材部分
- 成功添加故事大纲部分
- 保留原有内容不变
- 文件结构完整且格式正确

### 4.3 分步执行工作流测试

#### 测试步骤

1. **指定步骤执行**
   ```
   <novel_framework_refine>
   <path>step-test.md</path>
   <step>analyze</step>
   </novel_framework_refine>
   ```

2. **查看分析结果**
   - 系统应直接显示分析结果，跳过初始化步骤

3. **继续执行下一步**
   - 系统应展示选项列表

4. **选择一个选项**
   - 输入选项编号
   - 系统应执行相应工作流

5. **中断操作后恢复**
   - 关闭VSCode
   - 重新打开VSCode
   - 再次调用工具，应能恢复之前的状态

#### 预期结果

- 工具能够从指定步骤开始执行
- 状态保存和恢复功能正常工作
- 工作流执行过程中的每个步骤都能正确响应用户输入

### 4.4 指定区域完善测试

#### 测试步骤

1. **指定区域执行**
   ```
   <novel_framework_refine>
   <path>area-test.md</path>
   <area>character</area>
   </novel_framework_refine>
   ```

2. **验证直接进入角色设计**
   - 系统应直接进入角色设计相关选项

3. **完善角色设计**
   - 按提示完成角色设计

4. **检查结果**
   - 验证角色部分是否正确更新

#### 预期结果

- 工具能够直接定位到指定区域
- 跳过不必要的步骤，提高效率
- 正确完成指定区域的内容完善

### 4.5 错误处理测试

#### 测试步骤

1. **指定不存在的文件**
   ```
   <novel_framework_refine>
   <path>non-existent.md</path>
   </novel_framework_refine>
   ```
   - 系统应提示文件不存在，并询问是否创建

2. **指定非Markdown文件**
   ```
   <novel_framework_refine>
   <path>test.txt</path>
   </novel_framework_refine>
   ```
   - 系统应提示只支持Markdown格式

3. **指定无效步骤**
   ```
   <novel_framework_refine>
   <path>test.md</path>
   <step>invalid_step</step>
   </novel_framework_refine>
   ```
   - 系统应提示步骤无效，并使用默认步骤

4. **指定无效区域**
   ```
   <novel_framework_refine>
   <path>test.md</path>
   <area>invalid_area</area>
   </novel_framework_refine>
   ```
   - 系统应提示区域无效，并使用默认区域

#### 预期结果

- 工具能够优雅地处理各种错误情况
- 提供清晰的错误提示
- 在可能的情况下提供恢复或替代方案

## 5. 分块生成模式测试

### 测试步骤

1. **选择分块生成模式**
   ```
   <novel_framework_refine>
   <path>chunk-test.md</path>
   </novel_framework_refine>
   ```
   - 选择"使用分块生成模式"选项

2. **选择要生成的部分**
   - 选择多个框架部分进行生成

3. **中断生成过程**
   - 在生成过程中关闭VSCode
   - 重新打开并继续生成

4. **检查生成结果**
   - 验证所有选择的部分是否都已生成
   - 检查内容的完整性和连贯性

### 预期结果

- 分块生成模式能够正常工作
- 支持中断和恢复功能
- 生成的内容完整且符合预期

## 6. 状态管理测试

### 测试步骤

1. **启动工具并执行部分步骤**
   ```
   <novel_framework_refine>
   <path>state-test.md</path>
   </novel_framework_refine>
   ```

2. **关闭VSCode**
   - 不完成整个流程，直接关闭VSCode

3. **重新打开VSCode并启动工具**
   ```
   <novel_framework_refine>
   <path>state-test.md</path>
   </novel_framework_refine>
   ```

4. **验证状态恢复**
   - 系统应从上次中断的地方继续

### 预期结果

- 状态管理系统能够正确保存和恢复状态
- 用户可以无缝继续之前的工作
- 状态信息包含所有必要的上下文

## 7. 综合测试

### 测试步骤

1. **创建完整的小说框架**
   - 从头开始创建一个包含所有13个标准部分的框架

2. **使用不同的工作流程**
   - 测试所有可能的工作流路径
   - 验证每个工作流的功能正确性

3. **验证框架完整性**
   - 检查生成的框架是否包含所有必要部分
   - 验证内容的质量和一致性

### 预期结果

- 工具能够支持创建完整的小说框架
- 所有工作流都能正常工作
- 生成的框架结构清晰、内容丰富

## 8. 测试报告模板

### 测试信息
- **测试日期**：YYYY-MM-DD
- **测试环境**：[操作系统, VSCode版本]
- **测试人员**：[姓名]

### 测试结果摘要
- **通过测试**：[数量]
- **失败测试**：[数量]
- **未执行测试**：[数量]

### 详细测试结果
| 测试场景 | 测试步骤 | 预期结果 | 实际结果 | 状态 | 备注 |
|---------|---------|---------|---------|------|------|
| 新建框架文件 | 初始化工具 | 创建新文件 | | | |
| | 输入标题和概念 | 保存到文件 | | | |
| | ... | ... | | | |

### 发现的问题
1. [问题描述]
   - 严重程度：[高/中/低]
   - 复现步骤：[详细步骤]
   - 预期行为：[描述]
   - 实际行为：[描述]

### 改进建议
1. [建议描述]
   - 优先级：[高/中/低]
   - 理由：[详细说明]

## 9. 结论

本测试方案涵盖了小说框架完善工具的各种使用场景和功能点，通过执行这些测试可以全面验证工具的功能正确性、稳定性和用户体验。测试结果将帮助我们发现潜在问题并进一步优化工具。 